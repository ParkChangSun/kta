(this.webpackJsonpkta=this.webpackJsonpkta||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return j})),n.d(t,"a",(function(){return b}));var r=n(23),c=n(6),a=n.n(c),s=n(12),i=n(8),u=n(2),o=function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.dbService.collection("relationship").doc().set({requestorId:t,receiverId:n,requestedAt:Date.now()});case 2:console.log(t);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.dbService.collection("relationship").where("requestorId","==",t).where("receiverId","==",n).get();case 2:e.sent.docs[0].ref.delete();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.dbService.doc("profile/".concat(t.userId)).set(Object(r.a)(Object(r.a)({},t),{},{revisedAt:Date.now()}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=Object(u.createContext)({})},19:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return g}));var r=n(5),c=n(8).dbService,a=n(2),s=a.useState,i=a.useEffect,u=function(e,t){var n=s(!1),a=Object(r.a)(n,2),u=a[0],o=a[1],d=s(!1),j=Object(r.a)(d,2),b=j[0],l=j[1];return i((function(){return e===t&&l(!0),c.collection("relationship").where("requestorId","==",e).where("receiverId","==",t).onSnapshot((function(e){o(!e.empty)}))}),[e,t]),[u,b]},o=n(6),d=n.n(o),j=n(12),b=n(1),l=n(28).default,f=n(8).dbService,p=n(2),h=p.useState,O=p.useEffect,x=function(e){var t=h([]),n=Object(r.a)(t,2),c=n[0],a=n[1];return O((function(){e&&function(){var t=Object(j.a)(d.a.mark((function t(){var n,r,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.collection("relationship").where("requestorId","==",e).get();case 2:return n=t.sent,r=n.docs.map((function(e){return f.doc("profile/".concat(e.data().receiverId)).get()})),t.next=6,Promise.all(r);case 6:c=t.sent,a(c.map((function(e){return Object(b.jsx)(l,{otherData:e.data()},e.data().userId)})));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e]),c},v=n(28),m=n(2).useState,g=function(){var e=m([]),t=Object(r.a)(e,2),n=t[0],c=t[1];return[n,function(e){c(e.map((function(e){return Object(b.jsx)(v.default,{otherData:e.data()},e.data().userId)})))}]}},25:function(e,t,n){"use strict";var r=n(5),c=n(1),a=n(19),s=n(2),i=n(10);n(46);t.a=function(e){var t=e.otherId,n=Object(s.useContext)(i.a),u=Object(a.a)(n.userId,t),o=Object(r.a)(u,2),d=o[0];return o[1]?Object(c.jsx)("button",{className:"friendbutton",children:"it's you!"}):Object(c.jsx)("button",{onClick:function(){d?Object(i.b)(n.userId,t):Object(i.c)(n.userId,t)},className:"friendbutton",children:d?"delete friend":"add friend"})}},28:function(e,t,n){"use strict";n.r(t);var r=n(1),c=(n(2),n(17)),a=n(25);n(47);t.default=function(e){var t=e.otherData;return Object(r.jsxs)("li",{className:"smallprofile",children:[Object(r.jsx)("p",{children:t.userName}),Object(r.jsx)("p",{children:t.unit}),Object(r.jsx)(c.b,{to:"/profile/".concat(t.userId),children:"see profile"}),Object(r.jsx)(a.a,{otherId:t.userId})]})}},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(2),a=n.n(c),s=n(32),i=n.n(s),u=n(5),o=n(8),d=n(10),j=n(23),b=n(17),l=n(7),f=n(6),p=n.n(f),h=n(12),O=(n(45),function(){var e=new o.firebaseInstance.auth.GoogleAuthProvider,t=function(){var t=Object(h.a)(p.a.mark((function t(){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.authService.signInWithPopup(e);case 2:return n=t.sent,t.next=5,o.dbService.doc("profile/".concat(n.user.uid)).get();case 5:t.sent.exists||(r={userId:n.user.uid,userName:n.user.displayName,unit:""},Object(d.d)(r));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"auth",children:[Object(r.jsx)("p",{children:"Sign in"}),Object(r.jsx)("button",{onClick:t,children:"Google"})]})}),x=n(19),v=(n(52),function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(x.c)(),i=Object(u.a)(s,2),d=i[0],j=i[1],b=function(){var e=Object(h.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,o.dbService.collection("profile").where("userName","==",n).get();case 3:r=e.sent,j(r.docs);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"home",children:[Object(r.jsx)("p",{children:"are you looking for someone?"}),Object(r.jsxs)("form",{onSubmit:b,className:"searchForm",children:[Object(r.jsx)("input",{type:"text",placeholder:"type name here...",onChange:function(e){var t=e.target.value;a(t)}}),Object(r.jsx)("input",{type:"submit",value:"search"})]}),Object(r.jsx)("ul",{className:"usersfoundlist",children:d})]})}),m=(n(53),function(e){var t=e.setIsLoggedIn,n=Object(c.useContext)(d.a),a=Object(l.g)();return Object(r.jsx)("nav",{className:"navigation",children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(b.b,{to:"/",children:"Home"})}),Object(r.jsx)("li",{children:Object(r.jsx)(b.b,{to:"/myprofile",children:null===n||void 0===n?void 0:n.userName})}),Object(r.jsx)("li",{children:Object(r.jsx)("button",{onClick:function(){o.authService.signOut(),t(!1),a.push("/")},children:"Sign out"})})]})})}),g=function(){var e=Object(c.useContext)(d.a),t=Object(c.useState)(e.userName),n=Object(u.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(e.unit),j=Object(u.a)(i,2),b=j[0],l=j[1],f=function(e){var t=e.target,n=t.name,r=t.value;"name"===n?s(r):"unit"===n&&l(r)},O=function(){var t=Object(h.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),r={userId:e.userId,userName:a,unit:b},Object(d.d)(r);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){return o.dbService.doc("profile/".concat(e.userId)).onSnapshot((function(e){var t;l(null===(t=e.data())||void 0===t?void 0:t.unit)}))}),[e]),Object(r.jsxs)("form",{onSubmit:O,children:[Object(r.jsx)("input",{type:"text",name:"name",placeholder:"name",value:a,onChange:f}),Object(r.jsx)("input",{type:"text",placeholder:"unit that you belong to",name:"unit",value:b||"",onChange:f}),Object(r.jsx)("input",{type:"submit",value:"update profile"})]})},I=(n(54),function(){var e=Object(c.useContext)(d.a),t=Object(x.b)(e.userId);return Object(r.jsxs)("div",{className:"myprofile",children:[Object(r.jsx)("p",{children:"my profile"}),Object(r.jsx)(g,{}),Object(r.jsx)("p",{children:"friends"}),Object(r.jsx)("ul",{className:"friendslist",children:t})]})}),S=n(25),k=(n(55),function(e){var t=e.match,n=Object(c.useState)(null),a=Object(u.a)(n,2),s=a[0],i=a[1];Object(c.useEffect)((function(){(function(){var e=Object(h.a)(p.a.mark((function e(){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.dbService.doc("profile/".concat(t.params.userId)).get();case 2:n=e.sent,r=n.data(),i(r);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var d=Object(x.b)(null===s||void 0===s?void 0:s.userId);return Object(r.jsxs)("div",{className:"otherprofile",children:[Object(r.jsxs)("p",{children:[null===s||void 0===s?void 0:s.userName,"'s profile"]}),Object(r.jsxs)("p",{children:["unit : ",null===s||void 0===s?void 0:s.unit]}),Object(r.jsx)("p",{children:"list of friends"}),s?Object(r.jsx)("ul",{className:"friendslist",children:d}):Object(r.jsx)("p",{children:"loading"}),s&&Object(r.jsx)(S.a,{otherId:s.userId})]})}),w=function(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:"Page Not Found"}),Object(r.jsx)(b.b,{to:"/",children:"home"})]})},y=(n(56),function(){return Object(r.jsxs)("div",{className:"footer",children:[Object(r.jsx)("p",{children:"SGT Park"}),Object(r.jsx)("a",{href:"https://github.com/ParkChangSun/kta",children:"Github"})]})}),N=function(e){var t=e.isLoggedIn,n=e.setIsLoggedIn;return Object(r.jsxs)(b.a,{basename:"/kta",children:[t&&Object(r.jsx)(m,{setIsLoggedIn:n}),t?Object(r.jsxs)(l.d,{children:[Object(r.jsx)(l.b,{exact:!0,path:"/",children:Object(r.jsx)(v,{})}),Object(r.jsx)(l.b,{path:"/myprofile",children:Object(r.jsx)(I,{})}),Object(r.jsx)(l.b,{path:"/profile/:userId",render:function(e){return Object(r.jsx)(k,Object(j.a)({},e))}}),Object(r.jsx)(l.b,{component:w})]}):Object(r.jsxs)(l.d,{children:[Object(r.jsx)(l.b,{exact:!0,path:"/",children:Object(r.jsx)(O,{})}),Object(r.jsx)(l.a,{from:"*",to:"/"})]}),Object(r.jsx)(y,{})]})},C=function(){return Object(r.jsx)("p",{children:"Loading..."})};var D=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(null),i=Object(u.a)(s,2),j=i[0],b=i[1],l=Object(c.useState)(!1),f=Object(u.a)(l,2),p=f[0],h=f[1],O=Object(c.useState)(null),x=Object(u.a)(O,2),v=x[0],m=x[1];return Object(c.useEffect)((function(){o.authService.onAuthStateChanged((function(e){e?(m(e.uid),h(!0)):m("")}))}),[]),Object(c.useEffect)((function(){if(""!==v)return o.dbService.doc("profile/".concat(v)).onSnapshot((function(e){b(e.data()),a(!0)}));console.log("userid is null"),a(!0)}),[v]),Object(r.jsx)(d.a.Provider,{value:j,children:n?Object(r.jsx)(N,{isLoggedIn:p,setIsLoggedIn:h}):Object(r.jsx)(C,{})})};i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(D,{})}),document.getElementById("root"))},8:function(e,t,n){"use strict";n.r(t),n.d(t,"firebaseInstance",(function(){return c})),n.d(t,"authService",(function(){return a})),n.d(t,"dbService",(function(){return s})),n.d(t,"storageService",(function(){return i}));var r=n(21);n(39),n(41),n(58);r.a.initializeApp({apiKey:"AIzaSyC6I6OeQ0ByUaSJC2Ccsw7zxlbIGVPK0Uc",authDomain:"kta-backend.firebaseapp.com",databaseURL:"https://kta-backend.firebaseio.com",projectId:"kta-backend",storageBucket:"kta-backend.appspot.com",messagingSenderId:"775346930766",appId:"1:775346930766:web:174452c5fa046bd6be6f1f"});var c=r.a,a=r.a.auth(),s=r.a.firestore(),i=r.a.storage()}},[[57,1,2]]]);
//# sourceMappingURL=main.d3cd18be.chunk.js.map